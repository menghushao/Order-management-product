<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8" />
  <title>Excel Grid 106Ã—50</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    table { border-collapse: collapse; }
    th, td {
      border: 1px solid #ccc;
      min-width: 60px;
      height: 24px;
      text-align: center;
    }
    th { background: #eee; position: sticky; top: 0; z-index: 2; }
    th:first-child, td:first-child {
      position: sticky;
      left: 0;
      background: #f3f3f3;
      z-index: 1;
    }
    td:focus { outline: 2px solid #0078D7; }
    button { margin: 10px 0; padding: 8px 16px; }

    /* âœ… é«˜äº®æ¨£å¼ */
    td.hover-col, th.hover-col { background-color: #e0f3ff !important; }
    td.hover-row, th.hover-row { background-color: #fff4cc !important; }
  </style>
</head>
<body>

<h3>è¡¨æ ¼è³‡æ–™åº«ï¼ˆ106 Ã— 50ï¼‰</h3>
<button onclick="save()">ğŸ’¾ å„²å­˜ï¼ˆè¦†è“‹ index.htmlï¼‰</button>
<table id="grid">
  <thead><tr id="theadRow"><th></th></tr></thead>
  <tbody id="tbody"></tbody>
</table>

<!-- ğŸ”° gridData å…ˆå®šç¾©å¥½ï¼ˆæœƒè¢«è¦†è“‹ï¼‰ -->
<script>
const gridData = [["ç‰¹åƒ¹æ¨™","çµ„åˆé‡","çµ„åˆåƒ¹","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["A","2","35","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["B","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["C","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["D","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["E","","","","","","","","","","","","","","","ï¼œ","","é€š","","","è·¯","","","æ”¯","","","ä»˜","","","ï¼","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","ç¾é‡‘","ï¼µber Eats","LINEPAY","å…¨æ”¯ä»˜","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","ï¼œ","","é€š","","","è·¯","","","æŠ½","","","æˆ","","","ï¼","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","0","0.31","0.03","0.022","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["å“é …","å…¨ç¨±","ç°¡ç¨±","ç‰¹åƒ¹æ¨™","æˆæœ¬","é™„å±¬1","é™„å±¬2","é™„å±¬3","é™„å±¬4","é™„å±¬5","é™„å±¬6","é™„å±¬7","é™„å±¬8","é™„å±¬9","é™„å±¬10","<","","é€š","","","è·¯","","","å”®","","","åƒ¹","","","ï¼","","","","","","","","","","","","","","","","","","","",""],["é›è›‹ç³•","ç´”é›è›‹ç³•","ç´”","","3.22","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","é¤…ä¹¾(3é¡†)","é¤…","","4.88","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å·§å…‹åŠ›","å·§","","4.72","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å¥¶æ²¹","å¥¶","","3.26","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","é¹¹è›‹é»ƒ","é¹¹","","7.06","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æŠ¹èŒ¶","æŠ¹","","4.95","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç´…è±†","ç´…","","4.74","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","èŠéº»","èŠ","","3.68","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","è’œé¦™","è’œ","","3.93","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æ¢…å­èŠ±ç”Ÿ","èŠ±","","4.71","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","è‰è“","æ¢…","","3.61","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","é›™è‰²ä¹³é…ª","é…ª","","9.98","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å¥¶æ²¹é¹¹è›‹","å¥¶é¹¹","","5.69","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å·§å…‹åŠ›èŠ±ç”Ÿ","å·§èŠ±","","5.25","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å·§å…‹åŠ›èŠéº»","å·§èŠ","","4.45","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æŠ¹èŒ¶å·§å…‹åŠ›","æŠ¹å·§","","5.31","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æŠ¹èŒ¶ç´…è±†","æŠ¹ç´…","","5.3","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç‰ç±³æ¿ƒæ¹¯","æ¿ƒ","","3.61","ç„¦","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å†¬ç“œèŒ¶å¤–å¸¶","å†¬å¤–","","9.57","å»å†°","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å†¬ç“œèŒ¶å…§ç”¨","å†¬å…§","","1.68","å»å†°","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å†¬ç“œé®®å¥¶å¤–å¸¶","å†¬é®®å¤–","","28.39","å»å†°","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","å†¬ç“œé®®å¥¶å…§ç”¨","å†¬é®®å…§","","11.85","å»å†°","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç‡’ä»™è‰å¤–å¸¶","ä»™å¤–","","13.56","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç‡’ä»™è‰å…§ç”¨","ä»™å…§","","2.2","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æ‹¿éµå¤–å¸¶","æ‹¿å¤–","","65.02","ç¶“å…¸","ä½ç¶“","èŠ±æœ","é¦™è‰","ç„¦ç³–","èƒ¡æ¤’","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","æ‹¿éµå…§ç”¨","æ‹¿å…§","","29","ç¶“å…¸","ä½ç¶“","èŠ±æœ","é¦™è‰","ç„¦ç³–","èƒ¡æ¤’","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç¾å¼å¤–å¸¶","ç¾å¤–","","44.65","ç¶“å…¸","ä½ç¶“","èŠ±æœ","é¦™è‰","ç„¦ç³–","èƒ¡æ¤’","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ç¾å¼å…§ç”¨","ç¾å…§","","19","ç¶“å…¸","ä½ç¶“","èŠ±æœ","é¦™è‰","ç„¦ç³–","èƒ¡æ¤’","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","ä¸ç¹”å¸ƒæç¶²","æç¶²","","1.22","ç¶“å…¸","ä½ç¶“","èŠ±æœ","é¦™è‰","ç„¦ç³–","èƒ¡æ¤’","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""]];
// @@gridData@@
</script>

<script>
const ROWS = 106, COLS = 50;
const user = 'menghushao';
const repo = 'Order-management';
const path = 'index.html';
const branch = 'main';

const theadRow = document.getElementById('theadRow');
const tbody = document.getElementById('tbody');

// å»ºç«‹è¡¨é ­
for (let c = 0; c < COLS; c++) {
  let label = '', n = c;
  while (n >= 0) {
    label = String.fromCharCode(n % 26 + 65) + label;
    n = Math.floor(n / 26) - 1;
  }
  const th = document.createElement('th');
  th.textContent = label;
  theadRow.appendChild(th);
}

// å»ºç«‹è¡¨æ ¼
for (let r = 0; r < ROWS; r++) {
  const tr = document.createElement('tr');
  const rowTh = document.createElement('th');
  rowTh.textContent = r + 1;
  tr.appendChild(rowTh);
  for (let c = 0; c < COLS; c++) {
    const td = document.createElement('td');
    td.contentEditable = true;
    tr.appendChild(td);
  }
  tbody.appendChild(tr);
}

// å¡«å…¥ gridData è³‡æ–™
for (let r = 0; r < ROWS; r++) {
  for (let c = 0; c < COLS; c++) {
    const val = (gridData[r] && gridData[r][c]) || "";
    tbody.rows[r].cells[c + 1].textContent = val;
  }
}

// âœ… åå­—é«˜äº®åŠŸèƒ½
tbody.addEventListener('mouseover', e => {
  if (e.target.tagName !== 'TD') return;
  const td = e.target;
  clearHighlight();

  const tr = td.parentElement;
  const rowIndex = tr.rowIndex - 1;
  const colIndex = td.cellIndex;

  for (let r = 0; r < ROWS; r++) {
    const cell = tbody.rows[r].cells[colIndex];
    if (cell) cell.classList.add('hover-col');
  }

  [...tr.children].forEach(cell => cell.classList.add('hover-row'));

  theadRow.cells[colIndex].classList.add('hover-col');
  tbody.rows[rowIndex].cells[0].classList.add('hover-row');
});

tbody.addEventListener('mouseout', clearHighlight);
function clearHighlight() {
  document.querySelectorAll('.hover-col, .hover-row').forEach(el =>
    el.classList.remove('hover-col', 'hover-row')
  );
}

// âœ… é›¢é–‹å‰æç¤ºï¼ˆF5ã€è¿”å›ä¸Šä¸€é ã€é—œé–‰åˆ†é çš†æœƒè§¸ç™¼ï¼‰
window.addEventListener("beforeunload", function (e) {
  e.preventDefault();
  e.returnValue = '';
});

async function save() {
  const token = prompt("è«‹è¼¸å…¥ GitHub Token");
  if (!token) return;

  const values = Array.from({ length: ROWS }, (_, r) =>
    Array.from({ length: COLS }, (_, c) =>
      (tbody.rows[r]?.cells[c + 1]?.textContent || "").trim()
    )
  );

  const updatedCode = `const gridData = ${JSON.stringify(values)};\n// @@gridData@@`;
  const sourceURL = `https://raw.githubusercontent.com/${user}/${repo}/${branch}/${path}`;
  const original = await fetch(sourceURL).then(r => r.text());
  const replaced = original.replace(
    /const gridData = .*?\/\/ @@gridData@@/s,
    updatedCode
  );
  const base64 = btoa(unescape(encodeURIComponent(replaced)));

  const metaURL = `https://api.github.com/repos/${user}/${repo}/contents/${path}?ref=${branch}`;
  const { sha } = await fetch(metaURL, {
    headers: { Authorization: `Bearer ${token}` }
  }).then(r => r.json());

  const upload = await fetch(metaURL.replace('?ref=' + branch, ''), {
    method: 'PUT',
    headers: {
      Authorization: `Bearer ${token}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      message: 'ğŸ“¦ æ›´æ–° gridData ä¸¦ä¿ç•™åŠŸèƒ½ç¢¼',
      content: base64,
      sha,
      branch
    })
  });

  if (upload.ok) {
    alert('âœ… å„²å­˜æˆåŠŸï¼Œä¸‹æ¬¡æ‰“é–‹å°±æ˜¯æ–°è³‡æ–™');
  } else {
    const err = await upload.text();
    alert('âŒ å„²å­˜å¤±æ•—ï¼š' + err);
  }
}
</script>

</body>
</html>
